"use strict";(()=>{var e={};e.id=115,e.ids=[115],e.modules={2934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8893:e=>{e.exports=require("buffer")},2615:e=>{e.exports=require("http")},5240:e=>{e.exports=require("https")},8621:e=>{e.exports=require("punycode")},6162:e=>{e.exports=require("stream")},7360:e=>{e.exports=require("url")},1568:e=>{e.exports=require("zlib")},3661:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>j,patchFetch:()=>q,requestAsyncStorage:()=>w,routeModule:()=>g,serverHooks:()=>D,staticGenerationAsyncStorage:()=>I});var o={};r.r(o),r.d(o,{DELETE:()=>x,GET:()=>c,PUT:()=>f});var s=r(3036),n=r(5736),p=r(5262),a=r(942),i=r(9388),d=r(3305),u=r(2866),l=r(3516),m=r(5253);let c=(0,u.er)(u.rk.api,e=>{let t=e.headers.get("x-forwarded-for"),r=t?t.split(",")[0]:"unknown";return`prompts_get_id:${r}`})(async(e,{params:t})=>{let r=Date.now();try{let{id:o}=await t,s=(0,i.mq)(),{searchParams:n}=new URL(e.url),p=n.get("tier")||"explorer";if(!(0,l.z6)(o))return(0,m.DL)("Invalid UUID format in prompt request",{id:o}),a.NextResponse.json({error:"Invalid prompt ID format"},{status:400});let{data:u,error:c}=await s.from("prompts").select("*").eq("id",o).eq("is_published",!0).single();if(c)return(0,m.H)("Prompt not found",{id:o,error:c.message}),a.NextResponse.json({error:"Prompt not found"},{status:404});let{content:f,hasFullAccess:x}=(0,d.mz)(u.full_content,p,u.required_tier),g={...u,content:f,hasFullAccess:x,full_content:x?u.full_content:void 0},w=Date.now()-r;return m.kg.performance("GET /api/prompts/[id]",w,{promptId:o,tier:p,hasFullAccess:x}),a.NextResponse.json({prompt:g})}catch(t){let e=Date.now()-r;return(0,m.H)("API error in GET /api/prompts/[id]",{duration:e,error:t instanceof Error?t.message:"Unknown error"}),a.NextResponse.json({error:"Internal server error"},{status:500})}}),f=(0,u.er)(u.rk.api,e=>{let t=e.headers.get("x-forwarded-for"),r=t?t.split(",")[0]:"unknown";return`prompts_put_id:${r}`})(async(e,{params:t})=>{let r=Date.now();try{let{id:o}=await t,s=(0,i.mq)();if(!(0,l.z6)(o))return(0,m.DL)("Invalid UUID format in prompt update",{id:o}),a.NextResponse.json({error:"Invalid prompt ID format"},{status:400});let n=e.headers.get("content-type");if(!n||!n.includes("application/json"))return(0,m.DL)("Invalid content type in prompt update",{contentType:n,promptId:o}),a.NextResponse.json({error:"Content-Type must be application/json"},{status:400});let p=await e.json(),d=(0,l.rI)(l.i$,{...p,id:o});if(!d.success){let e=d.errors;return(0,m.DL)("Invalid prompt update data",{promptId:o,errors:e,dataKeys:Object.keys(p)}),a.NextResponse.json({error:"Invalid prompt data",details:e},{status:400})}let u=d.data,{data:c,error:f}=await s.from("prompts").update(u).eq("id",o).select().single();if(f)return(0,m.H)("Prompt update failed",{promptId:o,error:f.message,updateData:{title:u.title,category:u.cognitive_category}}),a.NextResponse.json({error:"Failed to update prompt"},{status:500});let x=Date.now()-r;return m.kg.performance("PUT /api/prompts/[id]",x,{promptId:o,title:c.title}),a.NextResponse.json({prompt:c})}catch(t){let e=Date.now()-r;return(0,m.H)("Unexpected error in PUT /api/prompts/[id]",{duration:e,error:t instanceof Error?t.message:"Unknown error"}),a.NextResponse.json({error:"Internal server error"},{status:400})}}),x=(0,u.er)(u.rk.api,e=>{let t=e.headers.get("x-forwarded-for"),r=t?t.split(",")[0]:"unknown";return`prompts_delete_id:${r}`})(async(e,{params:t})=>{let r=Date.now();try{let{id:o}=await t,s=(0,i.mq)();if(!(0,l.z6)(o))return(0,m.DL)("Invalid UUID format in prompt deletion",{id:o}),a.NextResponse.json({error:"Invalid prompt ID format"},{status:400});(0,m.DL)("Prompt soft-deletion attempt (marking as unpublished)",{promptId:o,ip:e.headers.get("x-forwarded-for")?.split(",")[0]||e.headers.get("x-real-ip")||"unknown"});let{error:n}=await s.from("prompts").update({published:!1,updated_at:new Date().toISOString()}).eq("id",o);if(n)return(0,m.H)("Prompt soft-deletion failed",{promptId:o,error:n.message}),a.NextResponse.json({error:"Failed to soft-delete prompt"},{status:500});let p=Date.now()-r;return m.kg.performance("DELETE /api/prompts/[id] (soft-delete)",p,{promptId:o}),a.NextResponse.json({success:!0})}catch(t){let e=Date.now()-r;return(0,m.H)("Unexpected error in DELETE /api/prompts/[id]",{duration:e,error:t instanceof Error?t.message:"Unknown error"}),a.NextResponse.json({error:"Internal server error"},{status:500})}}),g=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/prompts/[id]/route",pathname:"/api/prompts/[id]",filename:"route",bundlePath:"app/api/prompts/[id]/route"},resolvedPagePath:"/Users/vadimcusnir/GitRepo/ai-prompt-templates/packages/ai-prompt-templates/app/api/prompts/[id]/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:w,staticGenerationAsyncStorage:I,serverHooks:D}=g,j="/api/prompts/[id]/route";function q(){return(0,p.patchFetch)({serverHooks:D,staticGenerationAsyncStorage:I})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[522,753,309,322,390],()=>r(3661));module.exports=o})();