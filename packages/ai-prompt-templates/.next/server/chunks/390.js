"use strict";exports.id=390,exports.ids=[390],exports.modules={3305:(e,t,s)=>{s.d(t,{mz:()=>i});let a={explorer:1,architect:2,initiate:3,master:4},r={explorer:20,architect:40,initiate:70,master:100};function i(e,t,s){if(a[t]>=a[s])return{content:e,hasFullAccess:!0};let i=r[t],n=e.split(" "),o=Math.floor(n.length*(i/100));return{content:n.slice(0,o).join(" ")+"...\n\n\uD83D\uDD12 **Upgrade to see full content**",hasFullAccess:!1}}},5253:(e,t,s)=>{var a;s.d(t,{DL:()=>o,H:()=>n,kg:()=>i}),function(e){e.ERROR="error",e.WARN="warn",e.INFO="info",e.DEBUG="debug"}(a||(a={}));class r{shouldLog(e){return!!this.isDevelopment||!this.isProduction||"error"===e||"warn"===e}formatMessage(e){let t=e.timestamp,s=e.level.toUpperCase(),a=e.message,r=e.context?` | Context: ${JSON.stringify(e.context)}`:"",i=e.error?` | Error: ${e.error.message}`:"";return`[${t}] ${s}: ${a}${r}${i}`}addToBuffer(e){this.logBuffer.push(e),this.logBuffer.length>this.maxBufferSize&&this.logBuffer.shift()}async sendToExternalService(e){if(this.isProduction&&"error"===e.level)try{await fetch("/api/logs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}catch(e){console.error("Failed to send log to external service:",e)}}error(e,t,s){let a={level:"error",message:e,timestamp:new Date().toISOString(),context:t,error:s};this.addToBuffer(a),this.shouldLog("error")&&console.error(this.formatMessage(a)),this.sendToExternalService(a)}warn(e,t){let s={level:"warn",message:e,timestamp:new Date().toISOString(),context:t};this.addToBuffer(s),this.shouldLog("warn")&&console.warn(this.formatMessage(s))}info(e,t){let s={level:"info",message:e,timestamp:new Date().toISOString(),context:t};this.addToBuffer(s),this.shouldLog("info")&&console.info(this.formatMessage(s))}debug(e,t){let s={level:"debug",message:e,timestamp:new Date().toISOString(),context:t};this.addToBuffer(s),this.shouldLog("debug")&&console.debug(this.formatMessage(s))}security(e,t){let s={level:"warn",message:`SECURITY: ${e}`,timestamp:new Date().toISOString(),context:t};this.addToBuffer(s),console.warn(this.formatMessage(s)),this.sendToExternalService(s)}performance(e,t,s){let a={level:"info",message:`PERFORMANCE: ${e} took ${t}ms`,timestamp:new Date().toISOString(),context:s};this.addToBuffer(a),this.shouldLog("info")&&console.info(this.formatMessage(a))}getLogs(e){return e?this.logBuffer.filter(t=>t.level===e):[...this.logBuffer]}clearLogs(){this.logBuffer=[]}exportLogs(){return this.logBuffer.map(e=>this.formatMessage(e)).join("\n")}constructor(){this.isDevelopment=!1,this.isProduction=!0,this.logBuffer=[],this.maxBufferSize=100}}let i=new r,n=(e,t,s)=>i.error(e,t,s),o=(e,t)=>i.security(e,t)},2866:(e,t,s)=>{s.d(t,{er:()=>n,rk:()=>i});let a=new Map;async function r(e,t){let s=Date.now();t.windowMs;let r=a.get(e);return!r||r.resetTime<s?(a.set(e,{count:1,resetTime:s+t.windowMs}),{success:!0,remaining:t.max-1,resetTime:s+t.windowMs}):r.count>=t.max?{success:!1,remaining:0,resetTime:r.resetTime,message:t.message}:(r.count++,a.set(e,r),{success:!0,remaining:t.max-r.count,resetTime:r.resetTime})}setInterval(()=>{let e=Date.now();for(let[t,s]of a.entries())s.resetTime<e&&a.delete(t)},36e5);let i={auth:{windowMs:9e5,max:5,message:"Too many authentication attempts, please try again later",standardHeaders:!0,legacyHeaders:!1},api:{windowMs:6e4,max:100,message:"Too many requests, please try again later",standardHeaders:!0,legacyHeaders:!1},checkout:{windowMs:6e4,max:3,message:"Too many checkout attempts, please try again later",standardHeaders:!0,legacyHeaders:!1}};function n(e,t){return function(s){return async function(a,...i){let n=t(a),o=await r(n,e);return o.success?s(a,...i):new Response(JSON.stringify({error:o.message}),{status:429,headers:{"Content-Type":"application/json"}})}}}},9388:(e,t,s)=>{s.d(t,{mq:()=>r}),s(817),s(9362);var a=s(6981);function r(){!function(){let e=Object.entries({NEXT_PUBLIC_SUPABASE_URL:process.env.NEXT_PUBLIC_SUPABASE_URL,SUPABASE_SERVICE_ROLE_KEY:process.env.SUPABASE_SERVICE_ROLE_KEY}).filter(([,e])=>!e).map(([e])=>e);if(e.length>0)throw Error(`Missing required environment variables: ${e.join(", ")}. Please check your .env file and ensure all required variables are set.`);try{new URL(process.env.NEXT_PUBLIC_SUPABASE_URL)}catch{throw Error("Invalid NEXT_PUBLIC_SUPABASE_URL format")}if(!process.env.SUPABASE_SERVICE_ROLE_KEY.startsWith("eyJ"))throw Error("Invalid SUPABASE_SERVICE_ROLE_KEY format")}();let e=process.env.NEXT_PUBLIC_SUPABASE_URL,t=process.env.SUPABASE_SERVICE_ROLE_KEY;return(0,a.eI)(e,t,{auth:{autoRefreshToken:!1,persistSession:!1,detectSessionInUrl:!1},db:{schema:"public"},global:{headers:{"X-Client-Info":"ai-prompt-templates-server"}}})}},3516:(e,t,s)=>{s.d(t,{DH:()=>o,Hi:()=>c,Pp:()=>i,TD:()=>l,i$:()=>n,rI:()=>m,z6:()=>u});var a=s(1309),r=s(9693);let i=a.Ry({title:a.Z_().min(1,"Title is required").max(200,"Title must be less than 200 characters").regex(/^[a-zA-Z0-9\s\-_.,!?()]+$/,"Title contains invalid characters"),cognitive_category:a.Km(["deep_analysis","meaning_engineering","cognitive_frameworks","consciousness_mapping","advanced_systems"]),difficulty_tier:a.Km(["foundation","advanced","expert","architect"]),preview_content:a.Z_().min(10,"Preview content must be at least 10 characters").max(1e3,"Preview content must be less than 1000 characters").refine(e=>!e.includes("<script"),"Preview content contains invalid HTML"),full_content:a.Z_().min(50,"Full content must be at least 50 characters").max(5e4,"Full content must be less than 50000 characters").refine(e=>!e.includes("<script"),"Full content contains invalid HTML"),cognitive_depth_score:a.Rx().int("Cognitive depth score must be an integer").min(1,"Cognitive depth score must be at least 1").max(10,"Cognitive depth score must be at most 10"),pattern_complexity:a.Rx().int("Pattern complexity must be an integer").min(1,"Pattern complexity must be at least 1").max(5,"Pattern complexity must be at most 5"),base_price_cents:a.Rx().int("Price must be an integer").min(100,"Price must be at least 100 cents (€1)").max(1e5,"Price must be at most 100000 cents (€1000)"),meaning_layers:a.IX(a.Z_()).min(1,"At least one meaning layer is required").max(10,"Maximum 10 meaning layers allowed").refine(e=>e.every(e=>e.length>=3&&e.length<=500&&!e.includes("<script")),"Meaning layers contain invalid content"),anti_surface_features:a.IX(a.Z_()).min(1,"At least one anti-surface feature is required").max(10,"Maximum 10 anti-surface features allowed").refine(e=>e.every(e=>e.length>=3&&e.length<=500&&!e.includes("<script")),"Anti-surface features contain invalid content"),required_tier:a.Km(["explorer","architect","initiate","master"]).default("explorer"),is_published:a.O7().default(!1),quality_score:a.Rx().int("Quality score must be an integer").min(1,"Quality score must be at least 1").max(10,"Quality score must be at most 10").default(5),meta_tags:a.IX(a.Z_()).max(20,"Maximum 20 meta tags allowed").default([]),keywords:a.IX(a.Z_()).max(50,"Maximum 50 keywords allowed").default([])}),n=i.partial().extend({id:a.Z_().uuid("Invalid prompt ID format"),updated_at:a.Z_().datetime().optional()}),o=a.Ry({email:a.Z_().email("Invalid email format").min(5,"Email too short").max(254,"Email too long"),password:a.Z_().min(8,"Password must be at least 8 characters").max(128,"Password too long").regex(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/,"Password must contain lowercase, uppercase and number"),action:a.Km(["signin","signup"])}),l=a.Ry({tier:a.Km(["explorer","architect","initiate","master"]),userId:a.Z_().uuid("Invalid user ID format")}),c=a.Ry({search:a.Z_().max(100,"Search query too long").optional(),category:a.Km(["deep_analysis","meaning_engineering","cognitive_frameworks","consciousness_mapping","advanced_systems"]).optional(),tier:a.Km(["explorer","architect","initiate","master"]).default("explorer"),difficulty:a.Km(["foundation","advanced","expert","architect"]).optional(),minPrice:a.Rx().int().min(0).optional(),maxPrice:a.Rx().int().min(0).optional(),minScore:a.Rx().int().min(1).max(10).optional(),maxScore:a.Rx().int().min(1).max(10).optional()});function m(e,t){try{let s=e.parse(t);return{success:!0,data:s}}catch(e){if(e instanceof r.jm)return{success:!1,errors:e.issues.map(e=>`${e.path.join(".")}: ${e.message}`)};return{success:!1,errors:["Validation failed"]}}}function u(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}}};