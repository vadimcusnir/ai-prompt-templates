(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{6122:function(e,r,t){Promise.resolve().then(t.bind(t,4673))},1695:function(e,r,t){"use strict";var i=t(1219);t.o(i,"useRouter")&&t.d(r,{useRouter:function(){return i.useRouter}})},4673:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return l}});var i=t(7573),s=t(7653),o=t(4250),n=t(1695);function l(){let[e,r]=(0,s.useState)([]),[t,l]=(0,s.useState)(!0),{user:a,userTier:d}=(0,o.a)(),u=(0,n.useRouter)(),c=(0,s.useCallback)(async()=>{try{let e=await fetch("/api/prompts"),t=await e.json();r(t.prompts||[])}catch(e){console.error("Failed to fetch prompts:",e)}},[]);(0,s.useEffect)(()=>{a&&c()},[a,c]);let g=async(e,r)=>{try{(await fetch("/api/prompts/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({is_published:!r,published_at:r?null:new Date().toISOString()})})).ok?c():console.error("Error updating prompt")}catch(e){console.error("Error:",e)}},h=async e=>{if(confirm("Are you sure you want to delete this prompt?"))try{(await fetch("/api/prompts/".concat(e),{method:"DELETE"})).ok?c():console.error("Error deleting prompt")}catch(e){console.error("Error:",e)}};return t?(0,i.jsx)("div",{style:{padding:"2rem",textAlign:"center"},children:(0,i.jsx)("h2",{children:"Loading..."})}):a&&"elite"===d?(0,i.jsxs)("div",{style:{padding:"2rem",maxWidth:"1200px",margin:"0 auto"},children:[(0,i.jsxs)("div",{style:{marginBottom:"2rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsx)("h1",{style:{fontSize:"2rem",fontWeight:"bold"},children:"Cognitive Frameworks Management"}),(0,i.jsx)("button",{onClick:()=>u.push("/admin/create"),style:{padding:"0.75rem 1.5rem",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"0.375rem",cursor:"pointer",fontSize:"1rem",fontWeight:"500"},children:"Create New Framework"})]}),(0,i.jsx)("div",{style:{overflowX:"auto"},children:(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",border:"1px solid #e5e7eb"},children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{style:{backgroundColor:"#f9fafb"},children:[(0,i.jsx)("th",{style:{padding:"0.75rem",textAlign:"left",border:"1px solid #e5e7eb"},children:"Title"}),(0,i.jsx)("th",{style:{padding:"0.75rem",textAlign:"left",border:"1px solid #e5e7eb"},children:"Category"}),(0,i.jsx)("th",{style:{padding:"0.75rem",textAlign:"left",border:"1px solid #e5e7eb"},children:"Tier"}),(0,i.jsx)("th",{style:{padding:"0.75rem",textAlign:"left",border:"1px solid #e5e7eb"},children:"Price"}),(0,i.jsx)("th",{style:{padding:"0.75rem",textAlign:"left",border:"1px solid #e5e7eb"},children:"Quality Score"}),(0,i.jsx)("th",{style:{padding:"0.75rem",textAlign:"left",border:"1px solid #e5e7eb"},children:"Status"}),(0,i.jsx)("th",{style:{padding:"0.75rem",textAlign:"left",border:"1px solid #e5e7eb"},children:"Actions"})]})}),(0,i.jsx)("tbody",{children:e.map(e=>(0,i.jsxs)("tr",{style:{borderBottom:"1px solid #e5e7eb"},children:[(0,i.jsx)("td",{style:{padding:"0.75rem",border:"1px solid #e5e7eb"},children:e.title}),(0,i.jsx)("td",{style:{padding:"0.75rem",border:"1px solid #e5e7eb"},children:(0,i.jsx)("span",{style:{padding:"0.25rem 0.5rem",backgroundColor:"#8b5cf6",color:"white",borderRadius:"0.25rem",fontSize:"0.75rem"},children:e.cognitive_category})}),(0,i.jsx)("td",{style:{padding:"0.75rem",border:"1px solid #e5e7eb"},children:(0,i.jsx)("span",{style:{padding:"0.25rem 0.5rem",backgroundColor:"#3b82f6",color:"white",borderRadius:"0.25rem",fontSize:"0.75rem"},children:e.required_tier})}),(0,i.jsxs)("td",{style:{padding:"0.75rem",border:"1px solid #e5e7eb"},children:["â‚¬",(e.base_price_cents/100).toFixed(2)]}),(0,i.jsxs)("td",{style:{padding:"0.75rem",border:"1px solid #e5e7eb"},children:[e.quality_score,"/10"]}),(0,i.jsx)("td",{style:{padding:"0.75rem",border:"1px solid #e5e7eb"},children:(0,i.jsx)("span",{style:{padding:"0.25rem 0.5rem",backgroundColor:e.is_published?"#10b981":"#f59e0b",color:"white",borderRadius:"0.25rem",fontSize:"0.75rem"},children:e.is_published?"Published":"Draft"})}),(0,i.jsxs)("td",{style:{padding:"0.75rem",border:"1px solid #e5e7eb"},children:[(0,i.jsx)("button",{onClick:()=>g(e.id,e.is_published),style:{padding:"0.5rem 1rem",marginRight:"0.5rem",backgroundColor:e.is_published?"#f59e0b":"#10b981",color:"white",border:"none",borderRadius:"0.25rem",cursor:"pointer",fontSize:"0.875rem"},children:e.is_published?"Unpublish":"Publish"}),(0,i.jsx)("button",{onClick:()=>u.push("/admin/edit/".concat(e.id)),style:{padding:"0.5rem 1rem",marginRight:"0.5rem",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"0.25rem",cursor:"pointer",fontSize:"0.875rem"},children:"Edit"}),(0,i.jsx)("button",{onClick:()=>h(e.id),style:{padding:"0.5rem 1rem",backgroundColor:"#ef4444",color:"white",border:"none",borderRadius:"0.25rem",cursor:"pointer",fontSize:"0.875rem"},children:"Delete"})]})]},e.id))})]})}),0===e.length&&(0,i.jsxs)("div",{style:{textAlign:"center",padding:"3rem",color:"#6b7280"},children:[(0,i.jsx)("h3",{children:"No prompts found"}),(0,i.jsx)("p",{children:"Create your first cognitive framework to get started."})]})]}):(0,i.jsxs)("div",{style:{padding:"2rem",textAlign:"center"},children:[(0,i.jsx)("h2",{children:"Access Denied"}),(0,i.jsx)("p",{children:"You need Master tier access to view this page."})]})}},4250:function(e,r,t){"use strict";t.d(r,{AuthProvider:function(){return d},a:function(){return u}});var i=t(7573),s=t(7653),o=t(6940);t(4859);let n=()=>(0,o.createClientComponentClient)();var l=t(7200);let a=(0,s.createContext)(void 0);function d(e){let{children:r}=e,[t,o]=(0,s.useState)(null),[d,u]=(0,s.useState)(!0),[c,g]=(0,s.useState)("free"),h=n(),f=(0,s.useCallback)(async e=>{try{let{data:r,error:t}=await h.from("user_subscriptions").select("tier, status").eq("user_id",e).eq("status","active").single();t||!r?(l.kg.info("User has no active subscription, defaulting to free tier",{userId:e}),g("free")):(l.kg.info("User tier retrieved successfully",{userId:e,tier:r.tier}),g(r.tier))}catch(r){(0,l.H)("Error getting user tier",{userId:e,error:r instanceof Error?r.message:"Unknown error"}),g("free")}},[h]);(0,s.useEffect)(()=>{(async()=>{try{let{data:{session:r},error:t}=await h.auth.getSession();if(t)(0,l.H)("Error getting session",{error:t.message});else{var e;o(null!==(e=null==r?void 0:r.user)&&void 0!==e?e:null),(null==r?void 0:r.user)&&await f(r.user.id)}}catch(e){(0,l.H)("Session error",{error:e instanceof Error?e.message:"Unknown error"})}finally{u(!1)}})();let{data:{subscription:e}}=h.auth.onAuthStateChange(async(e,r)=>{var t,i;l.kg.info("Auth state changed",{event:e,userEmail:(null==r?void 0:null===(t=r.user)||void 0===t?void 0:t.email)?r.user.email.substring(0,3)+"***@"+r.user.email.split("@")[1]:"none"}),o(null!==(i=null==r?void 0:r.user)&&void 0!==i?i:null),(null==r?void 0:r.user)?await f(r.user.id):g("free"),u(!1)});return()=>e.unsubscribe()},[f,h.auth]);let m=async(e,r)=>{try{var t;let{data:i,error:s}=await h.auth.signInWithPassword({email:e,password:r});if(s)return(0,l.H)("Sign in failed",{email:e.substring(0,3)+"***@"+e.split("@")[1],error:s.message}),{error:s.message};return l.kg.info("User signed in successfully",{userId:null===(t=i.user)||void 0===t?void 0:t.id,email:e.substring(0,3)+"***@"+e.split("@")[1]}),{}}catch(r){return(0,l.H)("Unexpected error during sign in",{email:e.substring(0,3)+"***@"+e.split("@")[1],error:r instanceof Error?r.message:"Unknown error"}),{error:"An unexpected error occurred"}}},p=async(e,r)=>{try{var t;let{data:i,error:s}=await h.auth.signUp({email:e,password:r});if(s)return(0,l.H)("Sign up failed",{email:e.substring(0,3)+"***@"+e.split("@")[1],error:s.message}),{error:s.message};if(i.user&&!i.user.email_confirmed_at)return l.kg.info("User signup successful, email confirmation required",{userId:i.user.id,email:e.substring(0,3)+"***@"+e.split("@")[1]}),{error:"Please check your email to confirm your account"};return l.kg.info("User signup successful",{userId:null===(t=i.user)||void 0===t?void 0:t.id,email:e.substring(0,3)+"***@"+e.split("@")[1]}),{}}catch(r){return(0,l.H)("Unexpected error during sign up",{email:e.substring(0,3)+"***@"+e.split("@")[1],error:r instanceof Error?r.message:"Unknown error"}),{error:"An unexpected error occurred"}}},b=async()=>{try{let{error:e}=await h.auth.signOut();e?(0,l.H)("Sign out error",{error:e.message}):l.kg.info("User signed out successfully",{userId:null==t?void 0:t.id,email:(null==t?void 0:t.email)?t.email.substring(0,3)+"***@"+t.email.split("@")[1]:"unknown"})}catch(e){(0,l.H)("Sign out error",{error:e instanceof Error?e.message:"Unknown error"})}},x=async()=>{t&&await f(t.id)};return(0,i.jsx)(a.Provider,{value:{user:t,loading:d,userTier:c,signIn:m,signUp:p,signOut:b,refreshUserTier:x},children:r})}let u=()=>{let e=(0,s.useContext)(a);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},7200:function(e,r,t){"use strict";var i,s;t.d(r,{H:function(){return l},PN:function(){return d},kg:function(){return n},yN:function(){return a}}),(s=i||(i={})).ERROR="error",s.WARN="warn",s.INFO="info",s.DEBUG="debug";class o{shouldLog(e){return!!this.isDevelopment||!this.isProduction||"error"===e||"warn"===e}formatMessage(e){let r=e.timestamp,t=e.level.toUpperCase(),i=e.message,s=e.context?" | Context: ".concat(JSON.stringify(e.context)):"",o=e.error?" | Error: ".concat(e.error.message):"";return"[".concat(r,"] ").concat(t,": ").concat(i).concat(s).concat(o)}addToBuffer(e){this.logBuffer.push(e),this.logBuffer.length>this.maxBufferSize&&this.logBuffer.shift()}async sendToExternalService(e){if(this.isProduction&&"error"===e.level)try{await fetch("/api/logs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}catch(e){console.error("Failed to send log to external service:",e)}}error(e,r,t){let i={level:"error",message:e,timestamp:new Date().toISOString(),context:r,error:t};this.addToBuffer(i),this.shouldLog("error")&&console.error(this.formatMessage(i)),this.sendToExternalService(i)}warn(e,r){let t={level:"warn",message:e,timestamp:new Date().toISOString(),context:r};this.addToBuffer(t),this.shouldLog("warn")&&console.warn(this.formatMessage(t))}info(e,r){let t={level:"info",message:e,timestamp:new Date().toISOString(),context:r};this.addToBuffer(t),this.shouldLog("info")&&console.info(this.formatMessage(t))}debug(e,r){let t={level:"debug",message:e,timestamp:new Date().toISOString(),context:r};this.addToBuffer(t),this.shouldLog("debug")&&console.debug(this.formatMessage(t))}security(e,r){let t={level:"warn",message:"SECURITY: ".concat(e),timestamp:new Date().toISOString(),context:r};this.addToBuffer(t),console.warn(this.formatMessage(t)),this.sendToExternalService(t)}performance(e,r,t){let i={level:"info",message:"PERFORMANCE: ".concat(e," took ").concat(r,"ms"),timestamp:new Date().toISOString(),context:t};this.addToBuffer(i),this.shouldLog("info")&&console.info(this.formatMessage(i))}getLogs(e){return e?this.logBuffer.filter(r=>r.level===e):[...this.logBuffer]}clearLogs(){this.logBuffer=[]}exportLogs(){return this.logBuffer.map(e=>this.formatMessage(e)).join("\n")}constructor(){this.isDevelopment=!1,this.isProduction=!0,this.logBuffer=[],this.maxBufferSize=100}}let n=new o,l=(e,r,t)=>n.error(e,r,t),a=(e,r)=>n.warn(e,r),d=(e,r)=>n.info(e,r)}},function(e){e.O(0,[940,293,528,744],function(){return e(e.s=6122)}),_N_E=e.O()}]);