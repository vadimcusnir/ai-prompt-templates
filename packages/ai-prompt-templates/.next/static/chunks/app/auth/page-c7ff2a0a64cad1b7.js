(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[235],{7512:function(e,r,t){Promise.resolve().then(t.bind(t,3671))},1695:function(e,r,t){"use strict";var o=t(1219);t.o(o,"useRouter")&&t.d(r,{useRouter:function(){return o.useRouter}})},3671:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return d}});var o=t(7573),n=t(7653),i=t(1695),s=t(4250);function a(e){let{onSuccess:r,onToggleMode:t}=e,[i,a]=(0,n.useState)(""),[l,d]=(0,n.useState)(""),[u,c]=(0,n.useState)(!1),[g,m]=(0,n.useState)(""),{signIn:f}=(0,s.a)(),h=async e=>{e.preventDefault(),c(!0),m("");let t=await f(i,l);t.error?m(t.error):null==r||r(),c(!1)};return(0,o.jsxs)("div",{style:{maxWidth:"400px",margin:"0 auto",padding:"2rem",backgroundColor:"white",borderRadius:"1rem",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",border:"1px solid #e5e7eb"},children:[(0,o.jsx)("h2",{style:{fontSize:"1.5rem",fontWeight:"bold",marginBottom:"1.5rem",textAlign:"center",color:"#374151"},children:"Sign In to AI-Prompt-Templates"}),g&&(0,o.jsx)("div",{style:{backgroundColor:"#fef2f2",border:"1px solid #fecaca",color:"#dc2626",padding:"0.75rem",borderRadius:"0.5rem",marginBottom:"1rem",fontSize:"0.875rem"},children:g}),(0,o.jsxs)("form",{onSubmit:h,children:[(0,o.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,o.jsx)("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#374151",marginBottom:"0.5rem"},children:"Email"}),(0,o.jsx)("input",{type:"email",value:i,onChange:e=>a(e.target.value),required:!0,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"1rem",outline:"none",transition:"border-color 0.2s"},onFocus:e=>e.target.style.borderColor="#3b82f6",onBlur:e=>e.target.style.borderColor="#d1d5db",placeholder:"Enter your email"})]}),(0,o.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,o.jsx)("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#374151",marginBottom:"0.5rem"},children:"Password"}),(0,o.jsx)("input",{type:"password",value:l,onChange:e=>d(e.target.value),required:!0,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"1rem",outline:"none",transition:"border-color 0.2s"},onFocus:e=>e.target.style.borderColor="#3b82f6",onBlur:e=>e.target.style.borderColor="#d1d5db",placeholder:"Enter your password"})]}),(0,o.jsx)("button",{type:"submit",disabled:u,style:{width:"100%",padding:"0.75rem",backgroundColor:u?"#9ca3af":"#3b82f6",color:"white",fontSize:"1rem",fontWeight:"500",border:"none",borderRadius:"0.5rem",cursor:u?"not-allowed":"pointer",transition:"background-color 0.2s"},children:u?"Signing In...":"Sign In"})]}),t&&(0,o.jsxs)("div",{style:{textAlign:"center",marginTop:"1.5rem"},children:[(0,o.jsxs)("span",{style:{fontSize:"0.875rem",color:"#6b7280"},children:["Don't have an account?"," "]}),(0,o.jsx)("button",{onClick:t,style:{background:"none",border:"none",color:"#3b82f6",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer",textDecoration:"underline"},children:"Sign Up"})]})]})}function l(e){let{onToggleMode:r}=e,[t,i]=(0,n.useState)(""),[a,l]=(0,n.useState)(""),[d,u]=(0,n.useState)(""),[c,g]=(0,n.useState)(!1),[m,f]=(0,n.useState)(""),[h,b]=(0,n.useState)(""),{signUp:p}=(0,s.a)(),y=async e=>{if(e.preventDefault(),g(!0),f(""),b(""),a!==d){f("Passwords do not match"),g(!1);return}if(a.length<6){f("Password must be at least 6 characters long"),g(!1);return}let r=await p(t,a);r.error?r.error.includes("email")?b("Please check your email to confirm your account"):f(r.error):b("Account created successfully! Please check your email to confirm."),g(!1)};return(0,o.jsxs)("div",{style:{maxWidth:"400px",margin:"0 auto",padding:"2rem",backgroundColor:"white",borderRadius:"1rem",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",border:"1px solid #e5e7eb"},children:[(0,o.jsx)("h2",{style:{fontSize:"1.5rem",fontWeight:"bold",marginBottom:"1.5rem",textAlign:"center",color:"#374151"},children:"Create Your Account"}),m&&(0,o.jsx)("div",{style:{backgroundColor:"#fef2f2",border:"1px solid #fecaca",color:"#dc2626",padding:"0.75rem",borderRadius:"0.5rem",marginBottom:"1rem",fontSize:"0.875rem"},children:m}),h&&(0,o.jsx)("div",{style:{backgroundColor:"#f0fdf4",border:"1px solid #bbf7d0",color:"#166534",padding:"0.75rem",borderRadius:"0.5rem",marginBottom:"1rem",fontSize:"0.875rem"},children:h}),(0,o.jsxs)("form",{onSubmit:y,children:[(0,o.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,o.jsx)("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#374151",marginBottom:"0.5rem"},children:"Email"}),(0,o.jsx)("input",{type:"email",value:t,onChange:e=>i(e.target.value),required:!0,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"1rem",outline:"none",transition:"border-color 0.2s"},onFocus:e=>e.target.style.borderColor="#3b82f6",onBlur:e=>e.target.style.borderColor="#d1d5db",placeholder:"Enter your email"})]}),(0,o.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,o.jsx)("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#374151",marginBottom:"0.5rem"},children:"Password"}),(0,o.jsx)("input",{type:"password",value:a,onChange:e=>l(e.target.value),required:!0,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"1rem",outline:"none",transition:"border-color 0.2s"},onFocus:e=>e.target.style.borderColor="#3b82f6",onBlur:e=>e.target.style.borderColor="#d1d5db",placeholder:"At least 6 characters"})]}),(0,o.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,o.jsx)("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#374151",marginBottom:"0.5rem"},children:"Confirm Password"}),(0,o.jsx)("input",{type:"password",value:d,onChange:e=>u(e.target.value),required:!0,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"1rem",outline:"none",transition:"border-color 0.2s"},onFocus:e=>e.target.style.borderColor="#3b82f6",onBlur:e=>e.target.style.borderColor="#d1d5db",placeholder:"Confirm your password"})]}),(0,o.jsx)("button",{type:"submit",disabled:c,style:{width:"100%",padding:"0.75rem",backgroundColor:c?"#9ca3af":"#8b5cf6",color:"white",fontSize:"1rem",fontWeight:"500",border:"none",borderRadius:"0.5rem",cursor:c?"not-allowed":"pointer",transition:"background-color 0.2s"},children:c?"Creating Account...":"Create Account"})]}),r&&(0,o.jsxs)("div",{style:{textAlign:"center",marginTop:"1.5rem"},children:[(0,o.jsxs)("span",{style:{fontSize:"0.875rem",color:"#6b7280"},children:["Already have an account?"," "]}),(0,o.jsx)("button",{onClick:r,style:{background:"none",border:"none",color:"#3b82f6",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer",textDecoration:"underline"},children:"Sign In"})]})]})}function d(){let[e,r]=(0,n.useState)("login"),{user:t,loading:d}=(0,s.a)(),u=(0,i.useRouter)();return((0,n.useEffect)(()=>{t&&!d&&u.push("/dashboard")},[t,d,u]),d)?(0,o.jsx)("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f8fafc"},children:(0,o.jsx)("div",{children:"Loading..."})}):t?null:(0,o.jsx)("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f8fafc",padding:"1rem"},children:(0,o.jsxs)("div",{style:{width:"100%",maxWidth:"500px"},children:[(0,o.jsxs)("div",{style:{textAlign:"center",marginBottom:"2rem"},children:[(0,o.jsx)("h1",{style:{fontSize:"2rem",fontWeight:"bold",background:"linear-gradient(45deg, #3b82f6, #8b5cf6)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",marginBottom:"0.5rem"},children:"\uD83E\uDDE0 AI-Prompt-Templates"}),(0,o.jsx)("p",{style:{fontSize:"1rem",color:"#6b7280"},children:"Access advanced cognitive frameworks"})]}),"login"===e?(0,o.jsx)(a,{onSuccess:()=>{u.push("/dashboard")},onToggleMode:()=>r("register")}):(0,o.jsx)(l,{onToggleMode:()=>r("login")}),(0,o.jsx)("div",{style:{textAlign:"center",marginTop:"2rem",fontSize:"0.875rem",color:"#6b7280"},children:(0,o.jsxs)("p",{children:["By continuing, you agree to our"," ",(0,o.jsx)("a",{href:"/terms",style:{color:"#3b82f6",textDecoration:"underline"},children:"Terms of Service"})," ","and"," ",(0,o.jsx)("a",{href:"/privacy",style:{color:"#3b82f6",textDecoration:"underline"},children:"Privacy Policy"})]})})]})})}},4250:function(e,r,t){"use strict";t.d(r,{AuthProvider:function(){return d},a:function(){return u}});var o=t(7573),n=t(7653),i=t(6940);t(4859);let s=()=>(0,i.createClientComponentClient)();var a=t(7200);let l=(0,n.createContext)(void 0);function d(e){let{children:r}=e,[t,i]=(0,n.useState)(null),[d,u]=(0,n.useState)(!0),[c,g]=(0,n.useState)("free"),m=s(),f=(0,n.useCallback)(async e=>{try{let{data:r,error:t}=await m.from("user_subscriptions").select("tier, status").eq("user_id",e).eq("status","active").single();t||!r?(a.kg.info("User has no active subscription, defaulting to free tier",{userId:e}),g("free")):(a.kg.info("User tier retrieved successfully",{userId:e,tier:r.tier}),g(r.tier))}catch(r){(0,a.H)("Error getting user tier",{userId:e,error:r instanceof Error?r.message:"Unknown error"}),g("free")}},[m]);(0,n.useEffect)(()=>{(async()=>{try{let{data:{session:r},error:t}=await m.auth.getSession();if(t)(0,a.H)("Error getting session",{error:t.message});else{var e;i(null!==(e=null==r?void 0:r.user)&&void 0!==e?e:null),(null==r?void 0:r.user)&&await f(r.user.id)}}catch(e){(0,a.H)("Session error",{error:e instanceof Error?e.message:"Unknown error"})}finally{u(!1)}})();let{data:{subscription:e}}=m.auth.onAuthStateChange(async(e,r)=>{var t,o;a.kg.info("Auth state changed",{event:e,userEmail:(null==r?void 0:null===(t=r.user)||void 0===t?void 0:t.email)?r.user.email.substring(0,3)+"***@"+r.user.email.split("@")[1]:"none"}),i(null!==(o=null==r?void 0:r.user)&&void 0!==o?o:null),(null==r?void 0:r.user)?await f(r.user.id):g("free"),u(!1)});return()=>e.unsubscribe()},[f,m.auth]);let h=async(e,r)=>{try{var t;let{data:o,error:n}=await m.auth.signInWithPassword({email:e,password:r});if(n)return(0,a.H)("Sign in failed",{email:e.substring(0,3)+"***@"+e.split("@")[1],error:n.message}),{error:n.message};return a.kg.info("User signed in successfully",{userId:null===(t=o.user)||void 0===t?void 0:t.id,email:e.substring(0,3)+"***@"+e.split("@")[1]}),{}}catch(r){return(0,a.H)("Unexpected error during sign in",{email:e.substring(0,3)+"***@"+e.split("@")[1],error:r instanceof Error?r.message:"Unknown error"}),{error:"An unexpected error occurred"}}},b=async(e,r)=>{try{var t;let{data:o,error:n}=await m.auth.signUp({email:e,password:r});if(n)return(0,a.H)("Sign up failed",{email:e.substring(0,3)+"***@"+e.split("@")[1],error:n.message}),{error:n.message};if(o.user&&!o.user.email_confirmed_at)return a.kg.info("User signup successful, email confirmation required",{userId:o.user.id,email:e.substring(0,3)+"***@"+e.split("@")[1]}),{error:"Please check your email to confirm your account"};return a.kg.info("User signup successful",{userId:null===(t=o.user)||void 0===t?void 0:t.id,email:e.substring(0,3)+"***@"+e.split("@")[1]}),{}}catch(r){return(0,a.H)("Unexpected error during sign up",{email:e.substring(0,3)+"***@"+e.split("@")[1],error:r instanceof Error?r.message:"Unknown error"}),{error:"An unexpected error occurred"}}},p=async()=>{try{let{error:e}=await m.auth.signOut();e?(0,a.H)("Sign out error",{error:e.message}):a.kg.info("User signed out successfully",{userId:null==t?void 0:t.id,email:(null==t?void 0:t.email)?t.email.substring(0,3)+"***@"+t.email.split("@")[1]:"unknown"})}catch(e){(0,a.H)("Sign out error",{error:e instanceof Error?e.message:"Unknown error"})}},y=async()=>{t&&await f(t.id)};return(0,o.jsx)(l.Provider,{value:{user:t,loading:d,userTier:c,signIn:h,signUp:b,signOut:p,refreshUserTier:y},children:r})}let u=()=>{let e=(0,n.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},7200:function(e,r,t){"use strict";var o,n;t.d(r,{H:function(){return a},PN:function(){return d},kg:function(){return s},yN:function(){return l}}),(n=o||(o={})).ERROR="error",n.WARN="warn",n.INFO="info",n.DEBUG="debug";class i{shouldLog(e){return!!this.isDevelopment||!this.isProduction||"error"===e||"warn"===e}formatMessage(e){let r=e.timestamp,t=e.level.toUpperCase(),o=e.message,n=e.context?" | Context: ".concat(JSON.stringify(e.context)):"",i=e.error?" | Error: ".concat(e.error.message):"";return"[".concat(r,"] ").concat(t,": ").concat(o).concat(n).concat(i)}addToBuffer(e){this.logBuffer.push(e),this.logBuffer.length>this.maxBufferSize&&this.logBuffer.shift()}async sendToExternalService(e){if(this.isProduction&&"error"===e.level)try{await fetch("/api/logs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}catch(e){console.error("Failed to send log to external service:",e)}}error(e,r,t){let o={level:"error",message:e,timestamp:new Date().toISOString(),context:r,error:t};this.addToBuffer(o),this.shouldLog("error")&&console.error(this.formatMessage(o)),this.sendToExternalService(o)}warn(e,r){let t={level:"warn",message:e,timestamp:new Date().toISOString(),context:r};this.addToBuffer(t),this.shouldLog("warn")&&console.warn(this.formatMessage(t))}info(e,r){let t={level:"info",message:e,timestamp:new Date().toISOString(),context:r};this.addToBuffer(t),this.shouldLog("info")&&console.info(this.formatMessage(t))}debug(e,r){let t={level:"debug",message:e,timestamp:new Date().toISOString(),context:r};this.addToBuffer(t),this.shouldLog("debug")&&console.debug(this.formatMessage(t))}security(e,r){let t={level:"warn",message:"SECURITY: ".concat(e),timestamp:new Date().toISOString(),context:r};this.addToBuffer(t),console.warn(this.formatMessage(t)),this.sendToExternalService(t)}performance(e,r,t){let o={level:"info",message:"PERFORMANCE: ".concat(e," took ").concat(r,"ms"),timestamp:new Date().toISOString(),context:t};this.addToBuffer(o),this.shouldLog("info")&&console.info(this.formatMessage(o))}getLogs(e){return e?this.logBuffer.filter(r=>r.level===e):[...this.logBuffer]}clearLogs(){this.logBuffer=[]}exportLogs(){return this.logBuffer.map(e=>this.formatMessage(e)).join("\n")}constructor(){this.isDevelopment=!1,this.isProduction=!0,this.logBuffer=[],this.maxBufferSize=100}}let s=new i,a=(e,r,t)=>s.error(e,r,t),l=(e,r)=>s.warn(e,r),d=(e,r)=>s.info(e,r)}},function(e){e.O(0,[940,293,528,744],function(){return e(e.s=7512)}),_N_E=e.O()}]);